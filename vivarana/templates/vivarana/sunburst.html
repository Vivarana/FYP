{% extends 'vivarana/sunburst-base.html' %}
{% load staticfiles %}
{% block title %}SunBurst{% endblock %}


{% block body_block %}
   <div id="exampleModal" class="modal fade">
    <div class="modal-dialog">
        <div class="modal-content">
            <div class="modal-header">
                <button type="button" class="close" data-dismiss="modal" aria-hidden="true">&times;</button>
                 <h4 class="modal-title">Settings</h4>

            </div>
            <div class="modal-body">
                <input type="text" class="form-control" id="tokenfield-typeahead" value="red,green,blue" />
            </div>
            <div class="modal-footer">
                <button type="button" class="btn btn-default" data-dismiss="modal">Close</button>
                <button type="button" class="btn btn-primary">Save changes</button>
            </div>
        </div>
        <!-- /.modal-content -->
    </div>
    <!-- /.modal-dialog -->
</div>
<!-- /.modal -->

        <div id="main">
            <div id="sequence"></div>
            <div id="chart">
                <div id="explanation" style="visibility: hidden;">
                    <span id="percentage"></span><br/>
                    of all sequences of {{ grouped }} this sequence amounts to
                </div>
            </div>
        </div>
        <!--div id="subchart">
            <div id="subexplanation" style="visibility: hidden;">
                <span id="subpercentage"></span><br/>
                of visits begin with this sequence of pages
            </div>
        </div-->
        <div id="sidebar">
            <input type="checkbox" id="togglelegend"> Legend<br/>

            <div id="legend" style="visibility: hidden;"></div>
        </div>

    <script src="{% static "sunburst/sequences.js" %}"></script>
    <script src="{% static "sunburst/subchart.js" %}"></script>
    <script type="text/javascript">
    var percentageSliderValue = 0.005;
    seq_height = $("#sequence").css("height");
    $("#chart").css("top",seq_height);
        // Hack to make this example display correctly in an iframe on bl.ocks.org
        //d3.select(self.frameElement).style("height", "700px");
    showSunburst();
    $("#percentage-slider").on({'slide':function(){
        percentageSliderValue = $(this).val();
        $("#percentage-opacity-text").text("Minimum Percentage: "+percentageSliderValue+" %");

    },'change':function(){
        updateData();
    }});

    $("#exampleModal").draggable({
      handle: ".modal-header"
  });

    var engine = new Bloodhound({
  local: [{value: 'red'}, {value: 'blue'}, {value: 'green'} , {value: 'yellow'}, {value: 'violet'}, {value: 'brown'}, {value: 'purple'}, {value: 'black'}, {value: 'white'}],
  datumTokenizer: function(d) {
    return Bloodhound.tokenizers.whitespace(d.value);
  },
  queryTokenizer: Bloodhound.tokenizers.whitespace
});

engine.initialize();

$('#tokenfield-typeahead').tokenfield({
  typeahead: [null, { source: engine.ttAdapter() }]
});
    </script>
{% endblock %}